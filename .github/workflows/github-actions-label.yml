name: GitHub Actions Demo
on:
  pull_request:
    types: [labeled]
jobs:
  build:
    if: ${{ github.event.label.name == 'bug' }}
    runs-on: ubuntu-latest
    steps:
      - name: Print Event Info
        env:
          WEBHOOK_SECRET: ${{ secrets.WEBHOOK_SECRET }}
          WEBHOOK_KEY: ${{ secrets.WEBHOOK_KEY }}
        run: |
          echo "secret $WEBHOOK_SECRET key $WEBHOOK_KEY"
      - run: |
          echo "ðŸ”Ž The name of the branch is ${{ github.head_ref }}."
      - run: |
          curl -X POST \
            -H "Content-Type: application/json" \
            -H "Authorization: Bearer $WEBHOOK_KEY" \
            -H "X-Secret: $WEBHOOK_SECRET" \
            "https://cloudbuild.googleapis.com/v1/projects/striped-temple-418614/locations/global/triggers/test-webhook-label:webhook?trigger=test-webhook-label&projectId=striped-temple-418614" \
            -d '{"BRANCH_NAME": "${{ github.head_ref }}", "LAST_LABEL": "${{ github.event.label.name  }}"}'
